name: Build passes on Arch Linux with latest fcitx5 and cskk
on: [ push ]
concurrency:
  group: "archlinux_build"
  cancel-in-progress: true

jobs:
  build-check:
    name: Build check
    runs-on: ubuntu-24.04
    container: archlinux:latest
    steps:
      - name: checkout
        uses: actions/checkout@v4
      - name: check fcitx5-cskk version
        id: version
        run: |
          echo version=`bin/version.sh` >> ${GITHUB_OUTPUT}
      - name: check cskk version
        id: cskk_version
        run: |
          echo cskk_version=`bin/cskk_version.sh` >> ${GITHUB_OUTPUT}
      - name: Install required build environment
        uses: ./.github/actions/archlinux_build_environment_setup
      - name: Build fcitx5-cskk
        run: |
          cmake -B build \
            -DCMAKE_PREFIX_PATH=/opt/fcitx \
            -DENABLE_QT=On \
            -DUSE_QT6=On \
            -DFCITX_INSTALL_USE_FCITX_SYS_PATHS=ON
          cmake --build build --parallel
